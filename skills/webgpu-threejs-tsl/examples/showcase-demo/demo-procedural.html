<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Swappable Materials & Environments Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0a0a0a;
      color: #e0e0e0;
      overflow: hidden;
    }

    canvas { display: block; width: 100%; height: 100%; }

    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .nav-container {
      max-width: 1400px; margin: 0 auto; padding: 0 40px;
      display: flex; justify-content: space-between; align-items: center;
      height: 60px;
    }

    .nav-brand {
      font-size: 18px; font-weight: 700; color: #fff;
      display: flex; align-items: center; gap: 10px;
    }

    .nav-brand span {
      background: linear-gradient(135deg, #00d4ff 0%, #0066ff 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }

    .controls {
      position: fixed; top: 80px; right: 20px;
      background: rgba(15, 15, 15, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px; padding: 20px; width: 320px;
      backdrop-filter: blur(10px); z-index: 100;
      max-height: calc(100vh - 100px);
      overflow-y: auto;
    }

    .controls h3 {
      font-size: 14px; margin-bottom: 15px; color: #fff;
      text-transform: uppercase; letter-spacing: 1px;
    }

    .control-group { margin-bottom: 20px; }

    .control-group label {
      display: block; margin-bottom: 8px;
      font-size: 11px; color: #999;
      text-transform: uppercase; letter-spacing: 0.5px;
    }

    .button-group {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;
    }

    .btn {
      padding: 10px; background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #999; border-radius: 6px; cursor: pointer;
      font-size: 12px; transition: all 0.2s; text-align: center;
    }

    .btn:hover { border-color: #00d4ff; color: #00d4ff; }
    .btn.active {
      background: linear-gradient(135deg, rgba(0, 212, 255, 0.2) 0%, rgba(0, 102, 255, 0.2) 100%);
      border-color: #0066ff; color: #fff;
    }

    .slider-container { display: flex; align-items: center; gap: 10px; }
    .slider-container input[type="range"] {
      flex: 1; height: 4px; background: rgba(255, 255, 255, 0.1);
      border-radius: 2px; outline: none; -webkit-appearance: none;
    }

    .slider-container input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; width: 16px; height: 16px;
      background: #0066ff; border-radius: 50%; cursor: pointer;
    }

    .slider-value {
      min-width: 35px; text-align: right; font-size: 12px;
      color: #00d4ff; font-weight: 600; font-family: 'Monaco', monospace;
    }

    .info {
      position: fixed; top: 80px; left: 20px;
      background: rgba(15, 15, 15, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px; padding: 20px; max-width: 350px;
      backdrop-filter: blur(10px); z-index: 100;
    }

    .info h2 { font-size: 18px; margin-bottom: 15px; color: #00d4ff; }
    .info p { font-size: 13px; color: #999; line-height: 1.6; margin-bottom: 10px; }

    .stats {
      position: fixed; bottom: 20px; left: 20px;
      background: rgba(15, 15, 15, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px; padding: 15px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 11px; backdrop-filter: blur(10px);
    }

    .stats div { margin-bottom: 6px; color: #999; }
    .stats div:last-child { margin-bottom: 0; }
    .stats span { color: #00d4ff; font-weight: bold; }
  </style>
</head>
<body>
  <nav>
    <div class="nav-container">
      <div class="nav-brand">
        <span>⚡</span> Swappable Materials & Environments Demo
      </div>
    </div>
  </nav>

  <div class="info">
    <h2>✅ Procedural Demo Active</h2>
    <p>
      This demo uses <strong>procedural materials and lighting</strong> - no external assets needed!
    </p>
    <p>
      Swap between materials and environments to see real-time changes.
    </p>
  </div>

  <div class="controls">
    <h3>Materials</h3>
    <div class="control-group">
      <label>PBR Material Presets</label>
      <div class="button-group">
        <button class="btn active" data-material="polished-metal">Polished Metal</button>
        <button class="btn" data-material="brushed-metal">Brushed Metal</button>
        <button class="btn" data-material="wood">Wood</button>
        <button class="btn" data-material="plastic">Plastic</button>
        <button class="btn" data-material="ceramic">Ceramic</button>
        <button class="btn" data-material="rubber">Rubber</button>
      </div>
    </div>

    <h3>Environments</h3>
    <div class="control-group">
      <label>Lighting Presets</label>
      <div class="button-group">
        <button class="btn active" data-env="studio">Studio Neutral</button>
        <button class="btn" data-env="sunset">Warm Sunset</button>
        <button class="btn" data-env="night">Cool Night</button>
        <button class="btn" data-env="dramatic">Dramatic</button>
      </div>
    </div>

    <h3>Shapes</h3>
    <div class="control-group">
      <label>Geometry</label>
      <div class="button-group">
        <button class="btn active" data-shape="sphere">Sphere</button>
        <button class="btn" data-shape="cube">Cube</button>
        <button class="btn" data-shape="torus">Torus</button>
        <button class="btn" data-shape="knot">Knot</button>
      </div>
    </div>

    <h3>Manual Adjustments</h3>
    <div class="control-group">
      <label>Roughness</label>
      <div class="slider-container">
        <input type="range" id="roughness" min="0" max="100" value="20">
        <span class="slider-value" id="roughness-value">0.20</span>
      </div>
    </div>

    <div class="control-group">
      <label>Metalness</label>
      <div class="slider-container">
        <input type="range" id="metalness" min="0" max="100" value="100">
        <span class="slider-value" id="metalness-value">1.00</span>
      </div>
    </div>

    <div class="control-group">
      <label>Environment Intensity</label>
      <div class="slider-container">
        <input type="range" id="envIntensity" min="0" max="200" value="100">
        <span class="slider-value" id="envIntensity-value">1.00</span>
      </div>
    </div>
  </div>

  <div class="stats">
    <div>FPS: <span id="fps">0</span></div>
    <div>Material: <span id="current-material">Polished Metal</span></div>
    <div>Environment: <span id="current-env">Studio Neutral</span></div>
    <div>Triangles: <span id="triangles">0</span></div>
  </div>

  <canvas id="canvas"></canvas>

  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.171.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.171.0/examples/jsm/"
    }
  }
  </script>

  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    let scene, camera, renderer, controls, mesh, material;
    let lights = {};
    let frameCount = 0, lastTime = performance.now();

    // Material presets
    const MATERIALS = {
      'polished-metal': { roughness: 0.1, metalness: 1.0, color: 0xc0c0c0 },
      'brushed-metal': { roughness: 0.4, metalness: 1.0, color: 0xa8a8a8 },
      'wood': { roughness: 0.8, metalness: 0.0, color: 0x8b4513 },
      'plastic': { roughness: 0.5, metalness: 0.0, color: 0xff6b6b },
      'ceramic': { roughness: 0.3, metalness: 0.0, color: 0xf0f0f0 },
      'rubber': { roughness: 0.9, metalness: 0.0, color: 0x2c2c2c }
    };

    // Environment presets
    const ENVIRONMENTS = {
      'studio': {
        ambient: { color: 0xffffff, intensity: 0.5 },
        directional: { color: 0xffffff, intensity: 1.5, position: [5, 5, 5] },
        rim: { color: 0xffffff, intensity: 0.3, position: [-5, 2, -5] },
        background: 0x1a1a1a
      },
      'sunset': {
        ambient: { color: 0xffaa77, intensity: 0.4 },
        directional: { color: 0xff8844, intensity: 2.0, position: [8, 3, -2] },
        rim: { color: 0x6688ff, intensity: 0.6, position: [-5, 1, 3] },
        background: 0x332211
      },
      'night': {
        ambient: { color: 0x4466aa, intensity: 0.3 },
        directional: { color: 0x8899ff, intensity: 0.8, position: [2, 8, 5] },
        rim: { color: 0x334477, intensity: 1.2, position: [-3, -2, -5] },
        background: 0x0a0a1a
      },
      'dramatic': {
        ambient: { color: 0x332233, intensity: 0.2 },
        directional: { color: 0xffffff, intensity: 3.0, position: [-8, 5, 3] },
        rim: { color: 0xff0066, intensity: 1.5, position: [5, -2, -8] },
        background: 0x050505
      }
    };

    function init() {
      // Scene
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x1a1a1a);

      // Camera
      camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.set(3, 2, 5);

      // Renderer
      renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('canvas'), antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
      renderer.toneMapping = THREE.ACESFilmicToneMapping;
      renderer.toneMappingExposure = 1.0;

      // Controls
      controls = new OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      controls.autoRotate = true;
      controls.autoRotateSpeed = 2.0;

      // Create lights
      lights.ambient = new THREE.AmbientLight(0xffffff, 0.5);
      scene.add(lights.ambient);

      lights.directional = new THREE.DirectionalLight(0xffffff, 1.5);
      lights.directional.position.set(5, 5, 5);
      scene.add(lights.directional);

      lights.rim = new THREE.DirectionalLight(0xffffff, 0.3);
      lights.rim.position.set(-5, 2, -5);
      scene.add(lights.rim);

      // Material
      material = new THREE.MeshStandardMaterial({
        color: 0xc0c0c0,
        roughness: 0.1,
        metalness: 1.0
      });

      // Create initial shape
      createShape('sphere');

      // Event listeners
      setupEventListeners();

      // Start animation
      animate();

      console.log('✅ Procedural demo initialized successfully!');
    }

    function createShape(type) {
      if (mesh) {
        scene.remove(mesh);
        mesh.geometry.dispose();
      }

      let geometry, triangles;
      switch (type) {
        case 'sphere':
          geometry = new THREE.SphereGeometry(1.5, 64, 64);
          triangles = 4096;
          break;
        case 'cube':
          geometry = new THREE.BoxGeometry(2, 2, 2, 10, 10, 10);
          triangles = 600;
          break;
        case 'torus':
          geometry = new THREE.TorusGeometry(1.2, 0.5, 32, 64);
          triangles = 2048;
          break;
        case 'knot':
          geometry = new THREE.TorusKnotGeometry(1, 0.3, 128, 32);
          triangles = 4096;
          break;
      }

      mesh = new THREE.Mesh(geometry, material);
      scene.add(mesh);
      document.getElementById('triangles').textContent = triangles;
    }

    function applyMaterial(presetName) {
      const preset = MATERIALS[presetName];
      material.color.setHex(preset.color);
      material.roughness = preset.roughness;
      material.metalness = preset.metalness;
      material.needsUpdate = true;

      // Update sliders
      document.getElementById('roughness').value = preset.roughness * 100;
      document.getElementById('roughness-value').textContent = preset.roughness.toFixed(2);
      document.getElementById('metalness').value = preset.metalness * 100;
      document.getElementById('metalness-value').textContent = preset.metalness.toFixed(2);

      document.getElementById('current-material').textContent =
        presetName.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
    }

    function applyEnvironment(presetName) {
      const preset = ENVIRONMENTS[presetName];

      // Update lights
      lights.ambient.color.setHex(preset.ambient.color);
      lights.ambient.intensity = preset.ambient.intensity;

      lights.directional.color.setHex(preset.directional.color);
      lights.directional.intensity = preset.directional.intensity;
      lights.directional.position.set(...preset.directional.position);

      lights.rim.color.setHex(preset.rim.color);
      lights.rim.intensity = preset.rim.intensity;
      lights.rim.position.set(...preset.rim.position);

      scene.background.setHex(preset.background);

      document.getElementById('current-env').textContent =
        presetName.charAt(0).toUpperCase() + presetName.slice(1);
    }

    function setupEventListeners() {
      // Material buttons
      document.querySelectorAll('[data-material]').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('[data-material]').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          applyMaterial(btn.dataset.material);
        });
      });

      // Environment buttons
      document.querySelectorAll('[data-env]').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('[data-env]').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          applyEnvironment(btn.dataset.env);
        });
      });

      // Shape buttons
      document.querySelectorAll('[data-shape]').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('[data-shape]').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          createShape(btn.dataset.shape);
        });
      });

      // Roughness slider
      document.getElementById('roughness').addEventListener('input', (e) => {
        const value = parseFloat(e.target.value) / 100;
        material.roughness = value;
        document.getElementById('roughness-value').textContent = value.toFixed(2);
      });

      // Metalness slider
      document.getElementById('metalness').addEventListener('input', (e) => {
        const value = parseFloat(e.target.value) / 100;
        material.metalness = value;
        document.getElementById('metalness-value').textContent = value.toFixed(2);
      });

      // Environment intensity slider
      document.getElementById('envIntensity').addEventListener('input', (e) => {
        const value = parseFloat(e.target.value) / 100;
        lights.ambient.intensity *= value;
        lights.directional.intensity *= value;
        lights.rim.intensity *= value;
        document.getElementById('envIntensity-value').textContent = value.toFixed(2);
      });

      window.addEventListener('resize', onWindowResize);
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function updateFPS() {
      frameCount++;
      const now = performance.now();
      const delta = now - lastTime;

      if (delta >= 1000) {
        const fps = Math.round((frameCount * 1000) / delta);
        document.getElementById('fps').textContent = fps;
        frameCount = 0;
        lastTime = now;
      }
    }

    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
      updateFPS();
    }

    init();
  </script>
</body>
</html>
